description = "Wrap up the day and optionally the week"

prompt = """
Run the wrap-up session. Reviews tasks, updates projects, and writes a day summary. Optionally includes weekly wrap-up. This is an interactive process -- ask questions at each step before moving on.

## Step 1: Task Review

- Open today's daily note from daily/.
- Present all tasks from Tasks and ask the user one by one:
  - Is this done? (mark as `- [x]`)
  - Still in progress? (leave as `- [ ]`)
  - Blocked? (mark as `- [ ] text *(blocked: reason)*`)
  - Dropped? (mark as `- [ ] ~~text~~ *(dropped: reason)*` -- do NOT use `- [x]`)
  - Moving to another day? (mark as `- [ ] ~~text~~ → [date](link)` and add the task to the target day's Tasks section)

## Step 2: Habit Review

- Check the **Habits** scorecard in today's daily note.
- Present each habit and ask the user: did you do it today? (Yes/No)
- Update the Done column for each habit.
- For bad habits, "Yes" means the user slipped -- no judgment, just record it.

## Step 3: Log Entries

- Ask the user what notable things happened today that should be recorded in the Log & Notes section.
- Write plain bullet items. Only add timestamps if the user provides specific times.
- Tag each entry with relevant `#p-`, `#person-`, or topic tags.
- Link to project READMEs or KB articles where relevant.

## Step 4: Project Updates

- For each task that was completed or progressed, check if it relates to a project under projects/.
- Update the relevant project README.md files: add dev log entries, mark completed tasks, update status if needed.

## Step 5: Knowledge Base Updates

- If new information was learned during the day, ask the user if any knowledge base entries should be created or updated.
- Remember to append a changelog entry to any KB article that is edited.

## Step 6: Day Summary

- Write a brief summary in the **Day Summary** section of today's daily note.
- Content: 1-2 sentences on how the day went, then a bold-text line with task stats (done/total, blocked, moved, dropped).
- Present the summary to the user and ask if anything needs adjusting.

## Step 7: Weekly Wrap-Up (optional)

Ask the user: "Do you want to do the weekly wrap-up too?"

If yes:

- Open this week's weekly note from weekly/ (create if needed using `/weekly` flow).
- Read through all daily notes from this week.
- Compile **Highlights** — the week's best moments or achievements. Keep each to one line. Present and ask the user to confirm or edit.
- Collect incomplete tasks and unmet goals into **Carry-Over**. Ask the user which should carry over vs. be dropped.
- Ask for **Notes & Reflections** — anything on the user's mind about the week.
- Mark completed goals with `- [x]`.
- Flag active projects with no activity this week — ask if they should be paused.

If no, just update the weekly note's Daily Notes links to include today.

## Step 8: Squash Merge to Main

- Commit any remaining uncommitted changes on the daily branch.
- Switch to `main`: `git checkout main`.
- Squash-merge the daily branch: `git merge --squash daily/YYYY-MM-DD`.
- Commit with the message `journal: YYYY-MM-DD`.
- Delete the daily branch: `git branch -d daily/YYYY-MM-DD`.
- Push `main` if a remote is configured.

{{args}}
"""
